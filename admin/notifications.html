<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#127993;</text></svg>">
  <title>Notifications - TumourCare</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/pill-nav.css">

<body class="dashboard-body">
  <!-- Pill Navigation -->
  <div class="pill-nav-container">
    <nav class="pill-nav" aria-label="Primary">
      <a class="pill-logo" href="dashboard.html" aria-label="Home">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em"
            font-size="90">&#127993;</text></svg>
      </a>

      <div class="pill-nav-items desktop-only">
        <ul class="pill-list" role="menubar">
          <li role="none">
            <a role="menuitem" href="dashboard.html" class="pill" aria-label="Dashboard">
              <span class="hover-circle" aria-hidden="true"></span>
              <span class="label-stack">
                <span class="pill-label">Dashboard</span>
                <span class="pill-label-hover" aria-hidden="true">Dashboard</span>
              </span>
            </a>
          </li>
          <li role="none">
            <a role="menuitem" href="manage-doctors.html" class="pill" aria-label="Manage Doctors">
              <span class="hover-circle" aria-hidden="true"></span>
              <span class="label-stack">
                <span class="pill-label">Manage Doctors</span>
                <span class="pill-label-hover" aria-hidden="true">Manage Doctors</span>
              </span>
            </a>
          </li>
          <li role="none">
            <a role="menuitem" href="notifications.html" class="pill is-active" aria-label="Notifications">
              <span class="hover-circle" aria-hidden="true"></span>
              <span class="label-stack">
                <span class="pill-label">Notifications</span>
                <span class="pill-label-hover" aria-hidden="true">Notifications</span>
              </span>
            </a>
          </li>
          <li role="none">
            <a role="menuitem" href="#" id="logoutBtn" class="pill pill-btn-outline" aria-label="Logout">
              <span class="hover-circle" aria-hidden="true"></span>
              <span class="label-stack">
                <span class="pill-label">Logout</span>
                <span class="pill-label-hover" aria-hidden="true">Logout</span>
              </span>
            </a>
          </li>
        </ul>
      </div>

      <button class="mobile-menu-button mobile-only" aria-label="Toggle menu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </nav>

    <div class="mobile-menu-popover mobile-only">
      <ul class="mobile-menu-list">
        <li><a href="dashboard.html" class="mobile-menu-link">Dashboard</a></li>
        <li><a href="manage-doctors.html" class="mobile-menu-link">Manage Doctors</a></li>
        <li><a href="notifications.html" class="mobile-menu-link is-active">Notifications</a></li>
        <li><a href="#" id="logoutBtnMobile" class="mobile-menu-link">Logout</a></li>
      </ul>
    </div>
  </div>
  <div class="container">
    <div class="breadcrumb"><a href="dashboard.html">Dashboard</a> <span>â€º</span> Notifications</div>
    <h1>Notifications</h1>
    <div id="notifList" class="list-container">
      <p class="loading">Loading...</p>
    </div>
  </div>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  <script src="../js/firebase-config.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/auth-guard.js"></script>
  <script src="../js/notifications.js"></script>
  <script>
    requireAuth('admin').then(function (user) {
      onNotificationsChange(user.uid, function (notifs) {
        var container = document.getElementById('notifList');
        if (notifs.length === 0) { container.innerHTML = '<p>No notifications.</p>'; return; }
        container.innerHTML = '';
        notifs.forEach(function (n) {
          var card = createElement('div', { className: 'card' + (n.read ? '' : ' card-unread') });
          var dateStr = n.createdAt ? new Date(n.createdAt.seconds * 1000).toLocaleString() : '';
          card.innerHTML = '<p>' + escapeHtml(n.message) + '</p><p class="text-muted">' + dateStr + '</p>';
          if (!n.read) {
            card.addEventListener('click', function () { markAsRead(n.id); card.classList.remove('card-unread'); });
          }
          container.appendChild(card);
        });
      });
      document.getElementById('logoutBtn').addEventListener('click', function (e) { e.preventDefault(); logoutUser(); });
      var logoutBtnMobile = document.getElementById('logoutBtnMobile');
      if (logoutBtnMobile) logoutBtnMobile.addEventListener('click', function (e) { e.preventDefault(); logoutUser(); });
    });
  </script>
  <!-- GSAP Core for PillNav animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="../js/pill-nav.js"></script>
</body>

</html>